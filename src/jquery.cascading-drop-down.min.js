/*
 * ssdCascadingDropDown jQuery plugin
 * Examples and documentation at: https://github.com/sebastiansulinski/cascading-dropdown
 * Copyright (c) 2015 Sebastian Sulinski
 * Version: 1.0.0 (03-MAR-2015)
 * Licensed under the MIT.
 * Requires: jQuery v1.9 or later
 */
!function(t){t.fn.ssdCascadingDropDown=function(a){"use strict";function n(t){return"undefined"==typeof t||""===t||t===!1||t.length<1}function r(t){t.preventDefault(),t.stopPropagation()}function e(){var t='<option value="';return t+=n(arguments[1])?"":arguments[1],t+='">',t+=n(arguments[0])?"Select one":arguments[0],t+="</option>"}function i(t){return e(t)}function u(a,n){var r=t.Deferred(),u=i(a);return t.each(n,function(t,a){u+=e(a.name,a.value),t+1===n.length&&r.resolve(u)}),r.promise()}function o(a,r){a.html(i(r)).prop("disabled",!0);var e=a.data(c.attrDataTarget);if(!n(e)){var u=t("[data-"+c.attrDataId+'="'+e+'"]'),l=u.data(c.attrDataDefaultLabel);u.length>0&&o(u,l)}}function l(a){var r=a.data(c.attrDataGroup),e=t("[data-"+c.attrDataGroup+'="'+r+'"]').not(":disabled"),i=[];return t.each(e,function(){var a=t(this).val();n(a)||i.push({name:t(this).prop("name"),value:t(this).val()})}),i}function d(a){return t.param(a)}function f(a){a.on("change",function(a){if(r(a),!t(this).is(":disabled")){var e=t(this).data(c.attrDataTarget),i=t(this).data(c.attrDataUrl),f=t(this).val();if(!n(i)&&!n(e)){var s=t("[data-"+c.attrDataId+'="'+e+'"]'),h=s.data(c.attrDataDefaultLabel);if(o(s,h),!n(f)){var D=l(t(this));t.getJSON(i+"?"+d(D),function(a){if(!a)throw new Error("Invalid data received!");t.when(u(h,a)).then(function(t){s.html(t).prop("disabled",!1)})})}}}})}function s(t){t.html(i(t.data(c.attrDataDefaultLabel))).prop("disabled",!0)}var c=t.extend({attrDataGroup:"group",attrDataId:"id",attrDataUrl:"url",attrDataTarget:"target",attrDataDefaultLabel:"default-label"},a);return this.each(function(){s(t(this).not(":enabled")),f(t(this))})}}(jQuery);