/*
 * ssdCascadingDropDown jQuery plugin
 * Examples and documentation at: https://github.com/sebastiansulinski/cascading-dropdown
 * Copyright (c) 2015 Sebastian Sulinski
 * Version: 1.0.0 (03-MAR-2015)
 * Licensed under the MIT.
 * Requires: jQuery v1.9 or later
 */
!function(t){t.fn.ssdCascadingDropDown=function(a){"use strict";function r(t){return"undefined"==typeof t||""===t||t===!1||t.length<1}function n(t){t.preventDefault(),t.stopPropagation()}function e(){var t='<option value="';return t+=r(arguments[1])?"":arguments[1],t+='">',t+=r(arguments[0])?"Select one":arguments[0],t+="</option>"}function i(t){return e(t)}function u(a,r){var n=t.Deferred(),u=i(a);return t.each(r,function(t,a){u+=e(a.name,a.value),t+1===r.length&&n.resolve(u)}),n.promise()}function o(a,n,e){n.html(i(e)).prop("disabled",!0);var u=n.data(c.attrDataTarget);if(!r(u)){var d=t("[data-"+c.attrDataGroup+'="'+a+'"][data-'+c.attrDataId+'="'+u+'"]'),l=d.data(c.attrDataDefaultLabel);d.length>0&&o(a,d,l)}}function d(a){var n=a.data(c.attrDataGroup),e=t("[data-"+c.attrDataGroup+'="'+n+'"]').not(":disabled"),i=[];return t.each(e,function(){var a=t(this).val();r(a)||i.push({name:t(this).prop("name"),value:t(this).val()})}),i}function l(a){return t.param(a)}function f(a){a.on("change",function(a){if(n(a),!t(this).is(":disabled")){var e=t(this).data(c.attrDataGroup),i=t(this).data(c.attrDataTarget),f=t(this).data(c.attrDataUrl),s=t(this).val();if(!r(f)&&!r(i)){var h=t("[data-"+c.attrDataGroup+'="'+e+'"][data-'+c.attrDataId+'="'+i+'"]'),D=h.data(c.attrDataDefaultLabel);if(o(e,h,D),!r(s)){var p=d(t(this));t.getJSON(f+"?"+l(p),function(a){if(!a)throw new Error("Invalid data received!");t.when(u(D,a)).then(function(t){h.html(t).prop("disabled",!1)})})}}}})}function s(t){t.html(i(t.data(c.attrDataDefaultLabel))).prop("disabled",!0)}var c=t.extend({attrDataGroup:"group",attrDataId:"id",attrDataUrl:"url",attrDataTarget:"target",attrDataDefaultLabel:"default-label"},a);return this.each(function(){s(t(this).not(":enabled")),f(t(this))})}}(jQuery);