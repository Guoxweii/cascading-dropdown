/*
 * ssdCascadingDropDown jQuery plugin
 * Examples and documentation at: https://github.com/sebastiansulinski/cascading-dropdown
 * Copyright (c) 2015 Sebastian Sulinski
 * Version: 1.0.0 (03-MAR-2015)
 * Licensed under the MIT.
 * Requires: jQuery v1.9 or later
 */
!function(a){a.fn.ssdCascadingDropDown=function(t){"use strict";function e(a){return"undefined"==typeof a||""===a||a===!1}function n(a){a.preventDefault(),a.stopPropagation()}function d(){var a='<option value="';return a+=e(arguments[1])?"":arguments[1],a+='">',a+=e(arguments[0])?"Select one":arguments[0],a+="</option>"}function r(a){return d(a)}function i(t,e){var n=a.Deferred(),i=r(t);return a.each(e,function(a,t){i+=d(t.name,t.value),a+1===e.length&&n.resolve(i)}),n.promise()}function u(t,n){t.html(r(n)).prop("disabled",!0);var d=t.data(f.dataTarget);if(!e(d)){var i=a("[data-"+f.dataId+'="'+d+'"]'),o=i.data(f.dataDefaultLabel);i.length>0&&u(i,o)}}function o(t){t.on("change",function(t){if(n(t),!a(this).is(":disabled")){var d=a(this).data(f.dataTarget),r=a(this).data(f.dataUrl),o=a(this).val();if(!e(d)){var l=a("[data-"+f.dataId+'="'+d+'"]'),s=l.data(f.dataDefaultLabel);return e(o)?void u(l,s):void a.getJSON(r+o,function(t){if(!t)throw new Error("Invalid data received!");a.when(i(s,t)).then(function(t){l.html(t).prop("disabled",!1),d=l.data(f.dataTarget),e(d)||(l=a("[data-"+f.dataId+'="'+d+'"]'),s=l.data(f.dataDefaultLabel),u(l,s))})})}}})}function l(a){a.html(r(a.data(f.dataDefaultLabel))).prop("disabled",!0)}var f=a.extend({dataId:"id",dataUrl:"url",dataTarget:"target",dataDefaultLabel:"default-label"},t);return this.each(function(){l(a(this).not(":enabled")),o(a(this))})}}(jQuery);